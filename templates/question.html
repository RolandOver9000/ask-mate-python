<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>{{ question.title[:20] }}{{ '...' if question.title|length>20 }} | AskMate</title>
</head>
<body>
    {% if question %}
        {% set current_question_index = question_ids.index(question.id) %}
        <h3>{{ question.title }}</h3>
        <div>
            {% for line in question.message.split("\n") %}
                {{ line }}<br>
            {% endfor %}
            <br>
        </div>
        {% if question.image %}
            <img src="{{ question.image }}" width="500">
        {% endif %}
        <p>
            <form action="" method="post">
                views: {{ question.view_number }} | likes: {{ question.vote_number }}
                <button type="submit" name="vote" value="Upvote,{{ question.id }},question">Upvote</button>
                &emsp;<button type="submit" name="vote" value="Downvote,{{ question.id }},question">Downvote</button>
            </form>
        </p>
        <div>
            <a href="{{ url_for('route_edit', question_id=question.id) }}">Edit question</a>
        </div>
        <div>
            <a href="{{ url_for('route_delete', question_id=question.id) }}">Delete question</a>
        </div>
        <div>
            {% if question_ids|length -1 > current_question_index %}
                <a href="{{ question_ids[current_question_index + 1] }}">Next question</a>
            {% endif %}
        </div>
        <div>
            {% if current_question_index > 0 %}
                <a href="{{ question_ids[current_question_index - 1] }}">Previous question</a>
            {% endif %}
        </div>
        <p>
            <a href="/">Return to main page</a>
        </p>
        {% if answers %}
            <a href="/question/{{ question.id }}/new-answer">Answer this question!</a>
            {% for answer in answers %}
                <p>
                    <div>
                        <strong>Answer at #{{ answer.submission_time }}</strong><br>
                            <form action="" method="post">
                                {% for line in answer.message.split("\n") %}
                                    {{ line }}<br>
                                    <p>
                                        Likes: {{ answer.vote_number }}
                                            <button type="submit" name="vote" value="Upvote,{{ answer.id }},answer">Upvote</button>
                                            &emsp;<button type="submit" name="vote" value="Downvote,{{ answer.id }},answer">Downvote</button>
                                    </p>
                                {% endfor %}
                            </form>
                    </div>
                    {% if answer.image %}
                        <br><img src="{{ answer.image }}" width="300">
                    {% endif %}
                </p>
            {% endfor %}
        {% else %}
            <a href="/question/{{ question.id }}/new-answer">Be the first to answer this question!</a>
        {% endif %}
    {% else %}
        <p>Question not found!</p>
    {% endif %}
</body>
</html>